<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>utils · BayesFitness</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesFitness</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">BayesFitness</a></li><li><a class="tocitem" href="../mcmc/">mcmc</a></li><li><a class="tocitem" href="../model/">model</a></li><li><a class="tocitem" href="../stats/">stats</a></li><li class="is-active"><a class="tocitem" href>utils</a></li><li><a class="tocitem" href="../vi/">vi (Variational Inference)</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>utils</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>utils</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mrazomej/BayesFitness.jl/blob/main/docs/src/utils.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="utils"><a class="docs-heading-anchor" href="#utils">utils</a><a id="utils-1"></a><a class="docs-heading-anchor-permalink" href="#utils" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="BayesFitness.utils.advi_to_df-Tuple{DataFrames.AbstractDataFrame, Distributions.Sampleable, Vector}" href="#BayesFitness.utils.advi_to_df-Tuple{DataFrames.AbstractDataFrame, Distributions.Sampleable, Vector}"><code>BayesFitness.utils.advi_to_df</code></a> — <span class="docstring-category">Method</span></header><section><div><p>advi<em>to</em>df(data::DataFrames.AbstractDataFrame, dist::Distribution.Sampleable,            vars::Vector{&lt;:Any}; kwargs)</p><p>Convert the output of automatic differentiation variational inference (ADVI) to a tidy dataframe.</p><p><strong>Arguments</strong></p><ul><li><code>data::DataFrames.AbstractDataFrame</code>: Tidy dataframe used to perform the ADVI inference. See <code>BayesFitness.vi</code> module for the dataframe requirements.</li><li><code>dist::Distributions.Sampleable</code>: The ADVI posterior sampleable distribution object.</li><li><code>vars::Vector{&lt;:Any}</code>: Vector of variable/parameter names from the ADVI run. </li></ul><p><strong>Optional Keyword Arguments</strong></p><ul><li><code>id_col::Symbol=:barcode</code>: Name of the column in <code>data</code> containing the barcode   identifier. The column may contain any type of entry.</li><li><code>time_col::Symbol=:time</code>: Name of the column in <code>data</code> defining the time point at which measurements were done. The column may contain any type of entry as long as <code>sort</code> will resulted in time-ordered names.</li><li><code>count_col::Symbol=:count</code>: Name of the column in <code>data</code> containing the raw barcode count. The column must contain entries of type <code>Int64</code>.</li><li><code>neutral_col::Symbol=:neutral</code>: Name of the column in <code>data</code> defining whether the barcode belongs to a neutral lineage or not. The column must contain entries of type <code>Bool</code>.</li><li><code>rm_T0::Bool=false</code>: Optional argument to remove the first time point from the inference. The data from this first time point is commonly of much lower quality. Therefore, removing this first time point might result in a better inference.</li><li><code>n_samples::Int=10_000</code>: Number of posterior samples to draw used for hierarchical models. Default is 10,000.</li></ul><p><strong>Returns</strong></p><ul><li><code>df::DataFrames.DataFrame</code>: DataFrame containing summary statistics of</li></ul><p>posterior samples for each parameter. Columns include:     - <code>mean, std</code>: posterior mean and standard deviation for each variable.     - <code>varname</code>: parameter name from the ADVI posterior distribution.     - <code>vartype</code>: Description of the type of parameter. The types are:         - <code>pop_mean_fitness</code>: Population mean fitness value <code>s̲ₜ</code>.         - <code>pop_std</code>: (Nuisance parameter) Log of standard deviation in the           likelihood function for the neutral lineages.         - <code>bc_fitness</code>: Mutant relative fitness <code>s⁽ᵐ⁾</code>.         - <code>bc_hyperfitness</code>: For hierarchical models, mutant hyperparameter           that connects the fitness over multiple experimental replicates or           multiple genotypes <code>θ⁽ᵐ⁾</code>.         - <code>bc_noncenter</code>: (Nuisance parameter) For hierarchical models,           non-centered samples used to connect the experimental replicates to           the hyperparameter <code>θ̃⁽ᵐ⁾</code>.         - <code>bc_deviations</code>: (Nuisance parameter) For hierarchical models,           samples that define the log of the deviation from the hyperparameter           fitness value <code>logτ⁽ᵐ⁾</code>.         - <code>bc_std</code>: (Nuisance parameter) Log of standard deviation in the           likelihood function for the mutant lineages.         - <code>freq</code>: (Nuisance parameter) Log of the Poisson parameter used to           define the frequency of each lineage.     - rep: Experimental replicate number.     - env: Environment for each parameter.     - id: Mutant or neutral strain ID.</p><p><strong>Notes</strong></p><ul><li>Converts multivariate posterior into summarized dataframe format.</li><li>Adds metadata like parameter type, replicate, strain ID, etc.</li><li>Can handle models with multiple replicates and environments.</li><li>Can handle models with hierarchical structure on genotypes.</li><li>Useful for post-processing ADVI results for further analysis and plotting.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mrazomej/BayesFitness.jl/blob/054f2e7e5830244d736af8b77e7922f579fb6866/src/utils.jl#L409-L474">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesFitness.utils.data_to_arrays-Tuple{DataFrames.AbstractDataFrame}" href="#BayesFitness.utils.data_to_arrays-Tuple{DataFrames.AbstractDataFrame}"><code>BayesFitness.utils.data_to_arrays</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">data_to_arrays(data; kwargs)</code></pre><p>Function to preprocess the tidy dataframe <code>data</code> into the corresponding inputs for the models in the <code>model</code> submodule.</p><p><strong>Arguments</strong></p><ul><li><code>data::DataFrames.AbstractDataFrame</code>: Tidy dataframe with the data to be used for sampling the model posterior distribution. </li></ul><p><strong>Optional Keyword Arguments</strong></p><ul><li><code>id_col::Symbol=:barcode</code>: Name of the column in <code>data</code> containing the barcode   identifier. The column may include any type of entry.</li><li><code>time_col::Symbol=:time</code>: Name of the column in <code>data</code> defining the time point at which measurements were done. The column may contain any type of entry as long as <code>sort</code> will result in time-ordered names.</li><li><code>count_col::Symbol=:count</code>: Name of the column in <code>data</code> containing the raw barcode count. The column must contain entries of type <code>Int64</code>.</li><li><code>neutral_col::Symbol=:neutral</code>: Name of the column in <code>data</code> defining whether the barcode belongs to a neutral lineage. The column must contain entries of type <code>Bool</code>.</li><li><code>rep_col::Union{Nothing,Symbol}=nothing</code>: Column indicating the experimental replicate each measurement belongs to. Default is <code>nothing</code>.</li><li><code>env_col::Union{Nothing,Symbol}=nothing</code>: Column indicating the environment in which each measurement was performed. Default is <code>nothing</code>.</li><li><code>genotype_col::Union{Nothing,Symbol}=nothing</code>: Column indicating the genotype each barcode belongs to when fitting a hierarchical model on genotypes. Default is <code>nothing</code>.</li><li><code>rm_T0::Bool=false</code>: Optional argument to remove the first time point from the inference. The data from this first time point is commonly of much lower quality. Therefore, removing this first time point might result in a better inference.</li><li><code>verbose::Bool=true</code>: Boolean indicating if printing statements should be made.</li></ul><p><strong>Returns</strong></p><ul><li><code>data_arrays::Dict</code>: Dictionary with the following elements:<ul><li><code>bc_ids</code>: List of barcode IDs in the order they are used for the inference.</li><li><code>neutral_ids</code>: List of neutral barcode IDs in the order they are used for the inference.</li><li><code>bc_count</code>: Count time series for each barcode. The options can be:<ul><li><code>Matrix{Int64}</code>: (n<em>time) × (n</em>bc) matrix with counts. Rows are time points, and columns are barcodes.</li><li><code>Array{Int64, 3}</code>: The same as the matrix, except the third dimension represents multiple experimental replicates.</li><li><code>Vector{Matrix{Int64}}</code>: List of matrices, one for each experimental replicate. This is when replicates have a different number of time points.</li></ul></li><li><code>bc_total</code>: Total number of barcodes per time point. The options can be:<ul><li><code>Vector{Int64}</code>: Equivalent to summing each matrix row.</li><li><code>Matrix{Int64}</code>: Equivalent to summing each row of each slice of the tensor.</li><li><code>Vector{Vector{Int64}}</code>: Equivalent to summing each matrix row.</li></ul></li><li><code>n_rep</code>: Number of experimental replicates.</li><li><code>n_time</code>: Number of time points. The options can be:<ul><li><code>Int64</code>: Number of time points on a single replicate or multiple replicates.</li><li><code>Vector{Int64}</code>: Number of time points per replicate when replicates have different lengths.</li></ul></li><li><code>envs</code>: List of environments. The options can be:<ul><li><code>String</code>: Single placeholder <code>env1</code></li><li><code>Vector{&lt;:Any}</code>: Environments in the order they were measured.</li><li><code>vector{Vector{&lt;:Any}}</code>: Environments per replicate when replicates have a different number of time points.</li></ul></li><li><code>n_env</code>: Number of environmental conditions.</li><li><code>genotypes</code>: List of genotypes for each of the non-neutral barcodes. The options can be:<ul><li><code>N/A</code>: String when no genotype information is given.</li><li><code>Vector{&lt;:Any}</code>: Vector of the corresponding genotype for each of the non-neutral barcodes in the order they are used for the inference.</li></ul></li><li><code>n_geno</code>: Number of genotypes. When no genotype information is provided, this defaults to zero.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mrazomej/BayesFitness.jl/blob/054f2e7e5830244d736af8b77e7922f579fb6866/src/utils.jl#L16-L89">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../stats/">« stats</a><a class="docs-footer-nextpage" href="../vi/">vi (Variational Inference) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 11 September 2023 19:50">Monday 11 September 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
